# 项目开发心得体会

我将从对项目需求分析、代码开发、Demo实现等三个方面，分享dbt-gaussdbdws这个开源项目的心得体会。

## 关于项目需求分析

因为我对GaussDB(DWS)比较熟悉了，已经接触有很多年，所以还是有信心能做好这个项目。

但是后面仔细分析需求，发现除了需要支持GaussDB(DWS)还要支持GaussDB，这两个其实是有差别的，前者是OLAP，主要是做数据仓库，后者是OLTP，主要是做事务性的业务系统数据库。

所以，在接下来的几天中，我一直在犹豫，纠结，如果搞砸了，怎么办？

再加上我在数据治理领域也快10年了，但是 `dbt-core` 对我来说并不是常用的，更别说要基于源码开发插件，这个对我来说也是不小的挑战。

幸好，华为技术支持团队及时拉群，对我的疑问也及时答疑解惑，才让我有了勇气做下去。

## 关于代码开发

在我开发的过程中，参考了dbt-postgres的代码实现。但是，我发现postgres的内核比GaussDB要高，而且物化视图的系统表有些也不存在。这就需要我仔细对比GaussDB和postgres的差异，找出差异后就容易实现了。

另外，GaussDB(DWS)的最新版本9.x对于某些视图是支持的，而8.x是不支持的，基于此，我增加了参数化的类型，给默认值也是优先支持最新版本。

经过不断的调试、测试，终于完成项目的开发。

## 关于Demo实现

在考虑Demo如何实现的过程中，当时也是经过很多的思考。因为既要用到GaussDB，又要用到GaussDB(DWS)，所以我就将jaffle_shop按数仓分层加工的思想来实现。

在GaussDB中做数据的标准化清洗，在GaussDB(DWS)中做数据的汇总加工，最后通过API对外提供数据服务。

为了实现Demo，我先对Demo的业务场景进行了分析，并且画了数据流图和建模，最后要基于CCE进行部署，画好部署架构。

接下来就是对Demo的开发，我先是开发基于虚拟机ECS的实现，然后再做容器化改造，这样一步一步，终于完成了Demo的开发、部署、验证。
